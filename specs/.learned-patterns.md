# Learned Patterns

This file captures patterns discovered during implementation that should be followed consistently.

---

## [2026-01-30] PHP Component Pattern

**Context**: Creating shared header component to consolidate 16 duplicate navbars
**Pattern**: PHP include-based components should define config defaults, validate required params, and escape all dynamic values with `htmlspecialchars()`
**Reason**: Prevents XSS vulnerabilities and provides consistent behavior when config is incomplete

---

## [2026-01-30] CSS Isolation Pattern

**Context**: Shared component CSS that must not conflict with existing page styles
**Pattern**: Wrap all component styles with a unique class (e.g., `.header-component`) to prevent CSS specificity conflicts
**Reason**: Existing pages have inline styles that may conflict with component styles

---

## [2026-01-30] Mobile Menu JavaScript IDs

**Context**: Mobile hamburger menu toggle functionality
**Pattern**: Use `#navbar-toggle` for hamburger button and `#navbar-dropdown` for mobile menu container - these IDs are expected by the JS
**Reason**: Existing JavaScript in index.php uses these exact IDs; changing them would break functionality

---

## [2026-01-30] Pilot Migration Conservative Approach

**Context**: Migrating index.php (3356 lines) to use shared header component
**Pattern**: When migrating complex pages with extensive legacy CSS/JS, mark legacy code with cleanup comments rather than removing immediately. This allows testing before cleanup.
**Reason**: Legacy CSS with `.header-component` wrapper won't conflict (different specificity). Removing too much at once risks breaking page layout. Phase 7 cleanup is safer after all pages are migrated.

---

## [2026-01-30] Header Config Search Params

**Context**: Passing search parameters to header component
**Pattern**: Include `search_value` in config from `$_GET` to preserve user's search input when page reloads
**Reason**: Search form must retain user's search value after submission for good UX

---

## [2026-01-30] Form Page Component Info Table Mobile Pattern

**Context**: Rendering data tables that need mobile-friendly display
**Pattern**: Render both a `<table>` and a `<div class="info-card">` with the same data. Use CSS to show table on desktop (>768px) and card on mobile (â‰¤768px)
**Reason**: Pure CSS solution avoids JavaScript complexity and ensures content is available immediately on all devices

---

## [2026-01-30] Form Input ARIA Accessibility Pattern

**Context**: Form inputs with hints and error messages
**Pattern**: Use `aria-describedby` referencing both hint and error element IDs (e.g., `aria-describedby="field-hint field-error"`), even if elements are empty
**Reason**: Screen readers will read the correct description when content is present, and skip empty elements

---

## [2026-01-30] Modal Auto-Redirect with MutationObserver

**Context**: Modal dialogs that auto-redirect after a countdown
**Pattern**: Use MutationObserver to watch for `is-open` class changes, starting/stopping countdown accordingly. Store timeout/interval IDs for cleanup.
**Reason**: Modal may be shown programmatically at any time; observer pattern handles all cases without explicit initialization calls

---
